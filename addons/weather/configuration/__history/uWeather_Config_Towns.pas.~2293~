unit uWeather_Config_Towns;

interface

uses
  System.Classes,
  System.SysUtils,
  System.DateUtils,
  System.UITypes,
  FMX.Effects,
  FMX.Dialogs,
  FMX.StdCtrls,
  FMX.Objects,
  FMX.Graphics,
  FMX.Types,
  FMX.Grid,
  FMX.Edit,
  FMX.Layouts,
  FMX.Filter.Effects,
  OXmlPDOM,
  ALFmxTabControl,
  uWeather_AllTypes,
  Bass;

type
  TADDON_WEATHER_CONFIG_TOWNS_NEWTOWNPANEL = record
    Time_Results: WideString;
    Forecast_Image: WideString;
    Temperature: WideString;
    Temrerature_Unit: WideString;
    Temperature_Description: WideString;
    City_Name: WideString;
    Country_Name: WideString;
    Country_Flag: TBitmap;
  end;

type
  TSEARCHTOWN_RESULTS = record
    woeid: string;
    name: string;
    state_1: string;
    country: string;
    country_code: string;
  end;

const
  cTemp_Towns = 'data\addons\weather\temp\Towns.xml';
  cTemp_Forcast = 'data\addons\weather\temp\ChoosenTown.xml';

const
  cPengui_Icons_Path = '\icons\pengui\';
  cClear_Icons_Path = '\icons\clear\';
  cIcy_Icons_Path = '\icons\icy\';

procedure Load;
procedure Free;

procedure Show;

procedure uWeather_Config_Towns_Edit(vLock: Boolean);
procedure uWeather_Config_Towns_Edit_SelectTown(vSelected: Integer);
procedure uWeather_Config_Towns_Edit_DeleteTown(vSelected: Integer);

procedure uWeather_Config_Towns_TownGoUp;
procedure uWeather_Config_Towns_TownGoDown;

procedure uWeather_Config_Towns_RefreshTown(mNum: Integer);
procedure uWeather_Config_Towsn_RefreshTownAll;

procedure Add_New_Town(vNumPanel: Integer; vNewTown: TADDON_WEATHER_CONFIG_TOWNS_NEWTOWNPANEL);

procedure uWeather_Config_Towns_AddNewTown(vNum: Integer; mWoeid, country_code: string);

// procedure uWeather_Config_Towns_CreateTown_Panel(mNum: Integer; mTownResults: TADDON_WEATHER_CONFIG_CREATE_PANEL);

var
  vSelected_Panel: TImage;
  vSelectedTown: Integer;
  vLoading_Integer: Integer;
  vNTXML: IXMLDocument;
  vNTRoot: PXMLNode;
  vNTNode: PXMLNode;
  vNTNode_1: PXMLNode;
  vNTNode_2: PXMLNode;
  vNTNode_3: PXMLNode;
  vNTAttribute: PXMLNode;

implementation

uses
  uLoad,
  uLoad_AllTypes,
  uWeather_Actions,
  uWeather_Convert,
  uWeather_SetAll,
  uWeather_Mouse,
  uWeather_Sounds,
  uWeather_Providers_Yahoo,
  uWeather_Providers_Yahoo_Config,
  uWeather_Providers_OpenWeatherMap,
  uWeather_Providers_OpenWeatherMap_Config,
  main;

procedure Load;
begin
  vWeather.Config.main.Right.Panels[1] := TPanel.Create(vWeather.Config.main.Right.Panel);
  vWeather.Config.main.Right.Panels[1].name := 'A_W_Config_Panels_1';
  vWeather.Config.main.Right.Panels[1].Parent := vWeather.Config.main.Right.Panel;
  vWeather.Config.main.Right.Panels[1].Align := TAlignLayout.Client;
  vWeather.Config.main.Right.Panels[1].Visible := True;

  vWeather.Config.main.Right.Towns.CityList := TVertScrollBox.Create(vWeather.Config.main.Right.Panels[1]);
  vWeather.Config.main.Right.Towns.CityList.name := 'A_W_Config_Towns_CityList_VerticalBox';
  vWeather.Config.main.Right.Towns.CityList.Parent := vWeather.Config.main.Right.Panels[1];
  vWeather.Config.main.Right.Towns.CityList.SetBounds(10, 10, vWeather.Config.main.Right.Panels[1].Width - 40,
    vWeather.Config.main.Right.Panels[1].Height - 20);
  vWeather.Config.main.Right.Towns.CityList.Visible := True;

  vWeather.Config.main.Right.Towns.Action := TPanel.Create(vWeather.Config.main.Right.Panels[1]);
  vWeather.Config.main.Right.Towns.Action.name := 'A_W_Config_Action_Panel';
  vWeather.Config.main.Right.Towns.Action.Parent := vWeather.Config.main.Right.Panels[1];
  vWeather.Config.main.Right.Towns.Action.SetBounds(vWeather.Config.main.Right.Panels[1].Width - 40, 0, 40, vWeather.Config.main.Right.Panels[1].Height);
  vWeather.Config.main.Right.Towns.Action.Visible := True;

  vWeather.Config.main.Right.Towns.Add_Town := TText.Create(vWeather.Config.main.Right.Towns.Action);
  vWeather.Config.main.Right.Towns.Add_Town.name := 'A_W_Config_Towns_Add';
  vWeather.Config.main.Right.Towns.Add_Town.Parent := vWeather.Config.main.Right.Towns.Action;
  vWeather.Config.main.Right.Towns.Add_Town.SetBounds(8, 18, 24, 24);
  vWeather.Config.main.Right.Towns.Add_Town.Font.Family := 'IcoMoon-Free';
  vWeather.Config.main.Right.Towns.Add_Town.Font.Size := 24;
  vWeather.Config.main.Right.Towns.Add_Town.TextSettings.FontColor := TAlphaColorRec.Deepskyblue;
  vWeather.Config.main.Right.Towns.Add_Town.Text := #$ea0a;
  vWeather.Config.main.Right.Towns.Add_Town.OnClick := addons.weather.Input.mouse_config.Text.OnMouseClick;
  vWeather.Config.main.Right.Towns.Add_Town.OnMouseEnter := addons.weather.Input.mouse_config.Text.OnMouseEnter;
  vWeather.Config.main.Right.Towns.Add_Town.OnMouseLeave := addons.weather.Input.mouse_config.Text.OnMouseLeave;
  vWeather.Config.main.Right.Towns.Add_Town.Visible := True;

  vWeather.Config.main.Right.Towns.Add_Town_Glow := TGlowEffect.Create(vWeather.Config.main.Right.Towns.Add_Town);
  vWeather.Config.main.Right.Towns.Add_Town_Glow.name := 'A_W_Config_Towns_Add_Glow';
  vWeather.Config.main.Right.Towns.Add_Town_Glow.Parent := vWeather.Config.main.Right.Towns.Add_Town;
  vWeather.Config.main.Right.Towns.Add_Town_Glow.Softness := 0.4;
  vWeather.Config.main.Right.Towns.Add_Town_Glow.GlowColor := TAlphaColorRec.Deepskyblue;
  vWeather.Config.main.Right.Towns.Add_Town_Glow.Opacity := 0.9;
  vWeather.Config.main.Right.Towns.Add_Town_Glow.Enabled := False;

  vWeather.Config.main.Right.Towns.EditLock := TText.Create(vWeather.Config.main.Right.Towns.Action);
  vWeather.Config.main.Right.Towns.EditLock.name := 'A_W_Config_Towns_Lock';
  vWeather.Config.main.Right.Towns.EditLock.Parent := vWeather.Config.main.Right.Towns.Action;
  vWeather.Config.main.Right.Towns.EditLock.SetBounds(12, 290, 24, 24);
  vWeather.Config.main.Right.Towns.EditLock.Font.Family := 'IcoMoon-Free';
  vWeather.Config.main.Right.Towns.EditLock.Font.Size := 24;
  vWeather.Config.main.Right.Towns.EditLock.TextSettings.FontColor := TAlphaColorRec.Deepskyblue;
  vWeather.Config.main.Right.Towns.EditLock.Text := #$e98f;
  vWeather.Config.main.Right.Towns.EditLock.TextSettings.HorzAlign := TTextAlign.Center;
  vWeather.Config.main.Right.Towns.EditLock.OnClick := addons.weather.Input.mouse_config.Text.OnMouseClick;
  vWeather.Config.main.Right.Towns.EditLock.OnMouseEnter := addons.weather.Input.mouse_config.Text.OnMouseEnter;
  vWeather.Config.main.Right.Towns.EditLock.OnMouseLeave := addons.weather.Input.mouse_config.Text.OnMouseLeave;
  vWeather.Config.main.Right.Towns.EditLock.Visible := True;

  vWeather.Config.main.Right.Towns.EditLock_Glow := TGlowEffect.Create(vWeather.Config.main.Right.Towns.EditLock);
  vWeather.Config.main.Right.Towns.EditLock_Glow.name := 'A_W_Config_Towns_Lock_Glow';
  vWeather.Config.main.Right.Towns.EditLock_Glow.Parent := vWeather.Config.main.Right.Towns.EditLock;
  vWeather.Config.main.Right.Towns.EditLock_Glow.Softness := 0.4;
  vWeather.Config.main.Right.Towns.EditLock_Glow.GlowColor := TAlphaColorRec.Deepskyblue;
  vWeather.Config.main.Right.Towns.EditLock_Glow.Opacity := 0.9;
  vWeather.Config.main.Right.Towns.EditLock_Glow.Enabled := False;

  vWeather.Config.main.Right.Towns.GoUp := TText.Create(vWeather.Config.main.Right.Towns.Action);
  vWeather.Config.main.Right.Towns.GoUp.name := 'A_W_Config_Towns_PosUp';
  vWeather.Config.main.Right.Towns.GoUp.Parent := vWeather.Config.main.Right.Towns.Action;
  vWeather.Config.main.Right.Towns.GoUp.SetBounds(8, 350, 24, 24);
  vWeather.Config.main.Right.Towns.GoUp.Font.Family := 'IcoMoon-Free';
  vWeather.Config.main.Right.Towns.GoUp.Font.Size := 24;
  vWeather.Config.main.Right.Towns.GoUp.TextSettings.FontColor := TAlphaColorRec.Grey;
  vWeather.Config.main.Right.Towns.GoUp.Text := #$ea41;
  vWeather.Config.main.Right.Towns.GoUp.OnClick := addons.weather.Input.mouse_config.Text.OnMouseClick;
  vWeather.Config.main.Right.Towns.GoUp.OnMouseEnter := addons.weather.Input.mouse_config.Text.OnMouseEnter;
  vWeather.Config.main.Right.Towns.GoUp.OnMouseLeave := addons.weather.Input.mouse_config.Text.OnMouseLeave;
  vWeather.Config.main.Right.Towns.GoUp.Visible := True;

  vWeather.Config.main.Right.Towns.GoUp_Glow := TGlowEffect.Create(vWeather.Config.main.Right.Towns.GoUp);
  vWeather.Config.main.Right.Towns.GoUp_Glow.name := 'A_W_Config_Towns_PosUp_Glow';
  vWeather.Config.main.Right.Towns.GoUp_Glow.Parent := vWeather.Config.main.Right.Towns.GoUp;
  vWeather.Config.main.Right.Towns.GoUp_Glow.Softness := 0.4;
  vWeather.Config.main.Right.Towns.GoUp_Glow.GlowColor := TAlphaColorRec.Deepskyblue;
  vWeather.Config.main.Right.Towns.GoUp_Glow.Opacity := 0.9;
  vWeather.Config.main.Right.Towns.GoUp_Glow.Enabled := False;

  vWeather.Config.main.Right.Towns.GoDown := TText.Create(vWeather.Config.main.Right.Towns.Action);
  vWeather.Config.main.Right.Towns.GoDown.name := 'A_W_Config_Towns_PosDown';
  vWeather.Config.main.Right.Towns.GoDown.Parent := vWeather.Config.main.Right.Towns.Action;
  vWeather.Config.main.Right.Towns.GoDown.SetBounds(8, 390, 24, 24);
  vWeather.Config.main.Right.Towns.GoDown.Font.Family := 'IcoMoon-Free';
  vWeather.Config.main.Right.Towns.GoDown.Font.Size := 24;
  vWeather.Config.main.Right.Towns.GoDown.TextSettings.FontColor := TAlphaColorRec.Grey;
  vWeather.Config.main.Right.Towns.GoDown.Text := #$ea43;
  vWeather.Config.main.Right.Towns.GoDown.OnClick := addons.weather.Input.mouse_config.Text.OnMouseClick;
  vWeather.Config.main.Right.Towns.GoDown.OnMouseEnter := addons.weather.Input.mouse_config.Text.OnMouseEnter;
  vWeather.Config.main.Right.Towns.GoDown.OnMouseLeave := addons.weather.Input.mouse_config.Text.OnMouseLeave;
  vWeather.Config.main.Right.Towns.GoDown.Visible := True;

  vWeather.Config.main.Right.Towns.GoDown_Glow := TGlowEffect.Create(vWeather.Config.main.Right.Towns.GoDown);
  vWeather.Config.main.Right.Towns.GoDown_Glow.name := 'A_W_Config_Towns_PosDown_Glow';
  vWeather.Config.main.Right.Towns.GoDown_Glow.Parent := vWeather.Config.main.Right.Towns.GoDown;
  vWeather.Config.main.Right.Towns.GoDown_Glow.Softness := 0.4;
  vWeather.Config.main.Right.Towns.GoDown_Glow.GlowColor := TAlphaColorRec.Deepskyblue;
  vWeather.Config.main.Right.Towns.GoDown_Glow.Opacity := 0.9;
  vWeather.Config.main.Right.Towns.GoDown_Glow.Enabled := False;

  vWeather.Config.main.Right.Towns.Delete_Icon := TText.Create(vWeather.Config.main.Right.Towns.Action);
  vWeather.Config.main.Right.Towns.Delete_Icon.name := 'A_W_Config_Towns_Delete';
  vWeather.Config.main.Right.Towns.Delete_Icon.Parent := vWeather.Config.main.Right.Towns.Action;
  vWeather.Config.main.Right.Towns.Delete_Icon.SetBounds(8, 480, 24, 24);
  vWeather.Config.main.Right.Towns.Delete_Icon.Font.Family := 'IcoMoon-Free';
  vWeather.Config.main.Right.Towns.Delete_Icon.Font.Size := 24;
  vWeather.Config.main.Right.Towns.Delete_Icon.TextSettings.FontColor := TAlphaColorRec.Grey;
  vWeather.Config.main.Right.Towns.Delete_Icon.Text := #$e9ac;
  vWeather.Config.main.Right.Towns.Delete_Icon.OnClick := addons.weather.Input.mouse_config.Text.OnMouseClick;
  vWeather.Config.main.Right.Towns.Delete_Icon.OnMouseEnter := addons.weather.Input.mouse_config.Text.OnMouseEnter;
  vWeather.Config.main.Right.Towns.Delete_Icon.OnMouseLeave := addons.weather.Input.mouse_config.Text.OnMouseLeave;
  vWeather.Config.main.Right.Towns.Delete_Icon.Visible := True;

  vWeather.Config.main.Right.Towns.Delete_Glow := TGlowEffect.Create(vWeather.Config.main.Right.Towns.Delete_Icon);
  vWeather.Config.main.Right.Towns.Delete_Glow.name := 'A_W_Config_Towns_Delete_Glow';
  vWeather.Config.main.Right.Towns.Delete_Glow.Parent := vWeather.Config.main.Right.Towns.Delete_Icon;
  vWeather.Config.main.Right.Towns.Delete_Glow.Softness := 0.4;
  vWeather.Config.main.Right.Towns.Delete_Glow.GlowColor := TAlphaColorRec.Red;
  vWeather.Config.main.Right.Towns.Delete_Glow.Opacity := 0.9;
  vWeather.Config.main.Right.Towns.Delete_Glow.Enabled := False;

  Show;
end;

procedure Free;
begin
  FreeAndNil(vWeather.Config.main.Right.Panels[1]);
end;

procedure Show;
begin
  if addons.weather.Action.Provider = 'yahoo' then
    uWeather_Providers_Yahoo_Config.Create_Towns
  else if addons.weather.Action.Provider = 'openweathermap' then
    uWeather_Providers_OpenWeatherMap_Config.Create_Towns;
end;

procedure Add_New_Town(vNumPanel: Integer; vNewTown: TADDON_WEATHER_CONFIG_TOWNS_NEWTOWNPANEL);
begin
  // SetLength(vWeather.Config.main.Right.Towns.Town, vNumPanel + 1);
  //
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Panel := TPanel.Create(vWeather.Config.main.Right.Towns.CityList);
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Panel.name := 'Weather_Config_Towns_CityNum_' + vNumPanel.ToString;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Panel.Parent := vWeather.Config.main.Right.Towns.CityList;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Panel.SetBounds(6, 6 + (vNumPanel * 86), vWeather.Config.main.Right.Towns.CityList.Width - 24, 80);
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Panel.OnClick := addons.weather.Input.mouse.Panel.OnMouseClick;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Panel.OnMouseEnter := addons.weather.Input.mouse.Panel.OnMouseEnter;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Panel.OnMouseLeave := addons.weather.Input.mouse.Panel.OnMouseLeave;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Panel.Tag := vNumPanel;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Panel.TagFloat := 1000;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Panel.Visible := True;
  //
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Glow_Panel := TGlowEffect.Create(vWeather.Config.main.Right.Towns.Town[vNumPanel].Panel);
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Glow_Panel.name := 'Weather_Config_Towns_CityNum_' + vNumPanel.ToString + '_Glow';
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Glow_Panel.Parent := vWeather.Config.main.Right.Towns.Town[vNumPanel].Panel;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Glow_Panel.GlowColor := TAlphaColorRec.Deepskyblue;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Glow_Panel.Opacity := 0.9;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Glow_Panel.Softness := 0.4;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Glow_Panel.Tag := vNumPanel;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Glow_Panel.Enabled := False;
  //
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Date := TLabel.Create(vWeather.Config.main.Right.Towns.Town[vNumPanel].Panel);
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Date.name := 'Weather_Config_Towns_CityNum_' + vNumPanel.ToString + '_Date';
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Date.Parent := vWeather.Config.main.Right.Towns.Town[vNumPanel].Panel;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Date.SetBounds(vWeather.Config.main.Right.Towns.Town[vNumPanel].Panel.Width - 410, 3, 400, 22);
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Date.Text := vNewTown.Time_Results;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Date.StyledSettings := vWeather.Config.main.Right.Towns.Town[vNumPanel].Date.StyledSettings -
  // [TStyledSetting.Size];
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Date.Font.Size := 14;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Date.TextSettings.HorzAlign := TTextAlign.Trailing;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Date.OnMouseEnter := addons.weather.Input.mouse.VLabel.OnMouseEnter;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Date.OnMouseLeave := addons.weather.Input.mouse.VLabel.OnMouseLeave;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Date.OnClick := addons.weather.Input.mouse.VLabel.OnMouseClick;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Date.Tag := vNumPanel;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Date.TagFloat := 1000;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Date.Visible := True;
  //
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Image := TText.Create(vWeather.Config.main.Right.Towns.Town[vNumPanel].Panel);
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Image.name := 'Weather_Config_Towns_CityNum_' + vNumPanel.ToString + '_Image';
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Image.Parent := vWeather.Config.main.Right.Towns.Town[vNumPanel].Panel;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Image.SetBounds(6, 6, 60, 60);
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Image.Font.Family := 'Weather Icons';
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Image.Font.Size := 36;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Image.TextSettings.FontColor := TAlphaColorRec.Deepskyblue;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Image.Text := vNewTown.Forecast_Image;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Image.OnMouseEnter := addons.weather.Input.mouse.Image.OnMouseEnter;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Image.OnMouseLeave := addons.weather.Input.mouse.Image.OnMouseLeave;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Image.OnClick := addons.weather.Input.mouse.Image.OnMouseClick;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Image.Tag := vNumPanel;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Image.TagFloat := 1000;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Image.Visible := True;
  //
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Temp := TLabel.Create(vWeather.Config.main.Right.Towns.Town[vNumPanel].Panel);
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Temp.name := 'Weather_Config_Towns_CityNum_' + vNumPanel.ToString + '_Temp';
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Temp.Parent := vWeather.Config.main.Right.Towns.Town[vNumPanel].Panel;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Temp.SetBounds(60, 10, 60, 17);
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Temp.Font.Size := 18;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Temp.Text := vNewTown.Temperature;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Temp.StyledSettings := vWeather.Config.main.Right.Towns.Town[vNumPanel].Temp.StyledSettings -
  // [TStyledSetting.Size];
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Temp.TextSettings.HorzAlign := TTextAlign.Leading;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Temp.OnMouseEnter := addons.weather.Input.mouse.VLabel.OnMouseEnter;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Temp.OnMouseLeave := addons.weather.Input.mouse.VLabel.OnMouseLeave;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Temp.OnClick := addons.weather.Input.mouse.VLabel.OnMouseClick;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Temp.Tag := vNumPanel;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Temp.TagFloat := 1000;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Temp.Visible := True;
  //
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Temp_Unit := TText.Create(vWeather.Config.main.Right.Towns.Town[vNumPanel].Panel);
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Temp_Unit.name := 'Weather_Config_Tonws_CityNum_' + vNumPanel.ToString + '_Temp_Unit';
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Temp_Unit.Parent := vWeather.Config.main.Right.Towns.Town[vNumPanel].Panel;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Temp_Unit.SetBounds(80, 8, 18, 18);
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Temp_Unit.Font.Family := 'Weather Icons';
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Temp_Unit.Font.Size := 18;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Temp_Unit.TextSettings.FontColor := TAlphaColorRec.Deepskyblue;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Temp_Unit.Text := vNewTown.Temrerature_Unit;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Temp_Unit.Visible := True;
  //
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Temp_Comment := TLabel.Create(vWeather.Config.main.Right.Towns.Town[vNumPanel].Panel);
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Temp_Comment.name := 'Weather_Config_Towns_CityNum_' + vNumPanel.ToString + '_Temp_Comment';
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Temp_Comment.Parent := vWeather.Config.main.Right.Towns.Town[vNumPanel].Panel;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Temp_Comment.SetBounds(6, 56, 400, 22);
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Temp_Comment.Font.Size := 16;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Temp_Comment.Text := vNewTown.Temperature_Description;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Temp_Comment.StyledSettings := vWeather.Config.main.Right.Towns.Town[vNumPanel].Temp_Comment.StyledSettings -
  // [TStyledSetting.Size];
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Temp_Comment.TextSettings.HorzAlign := TTextAlign.Leading;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Temp_Comment.OnMouseEnter := addons.weather.Input.mouse.VLabel.OnMouseEnter;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Temp_Comment.OnMouseLeave := addons.weather.Input.mouse.VLabel.OnMouseLeave;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Temp_Comment.OnClick := addons.weather.Input.mouse.VLabel.OnMouseClick;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Temp_Comment.Tag := vNumPanel;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Temp_Comment.TagFloat := 1000;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Temp_Comment.Visible := True;
  //
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].City_Name := TLabel.Create(vWeather.Config.main.Right.Towns.Town[vNumPanel].Panel);
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].City_Name.name := 'Weather_Config_Towns_CityNum_' + vNumPanel.ToString + '_CityName';
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].City_Name.Parent := vWeather.Config.main.Right.Towns.Town[vNumPanel].Panel;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].City_Name.SetBounds(106, 20, 100, 22);
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].City_Name.Text := 'Town : ';
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].City_Name.StyledSettings := vWeather.Config.main.Right.Towns.Town[vNumPanel].City_Name.StyledSettings -
  // [TStyledSetting.FontColor, TStyledSetting.Size];
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].City_Name.Font.Size := 16;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].City_Name.TextSettings.FontColor := TAlphaColorRec.Deepskyblue;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].City_Name.TextSettings.HorzAlign := TTextAlign.Leading;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].City_Name.OnMouseEnter := addons.weather.Input.mouse.VLabel.OnMouseEnter;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].City_Name.OnMouseLeave := addons.weather.Input.mouse.VLabel.OnMouseLeave;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].City_Name.OnClick := addons.weather.Input.mouse.VLabel.OnMouseClick;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].City_Name.Tag := vNumPanel;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].City_Name.TagFloat := 1000;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].City_Name.Visible := True;
  //
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].City_Name_V := TLabel.Create(vWeather.Config.main.Right.Towns.Town[vNumPanel].Panel);
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].City_Name_V.name := 'Weather_Config_Towns_CityNum_V_' + vNumPanel.ToString + '_CityName';
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].City_Name_V.Parent := vWeather.Config.main.Right.Towns.Town[vNumPanel].Panel;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].City_Name_V.SetBounds(174, 20, 400, 22);
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].City_Name_V.Text := vNewTown.City_Name;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].City_Name_V.StyledSettings := vWeather.Config.main.Right.Towns.Town[vNumPanel].City_Name_V.StyledSettings -
  // [TStyledSetting.Size];
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].City_Name_V.Font.Size := 16;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].City_Name_V.TextSettings.HorzAlign := TTextAlign.Leading;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].City_Name_V.OnMouseEnter := addons.weather.Input.mouse.VLabel.OnMouseEnter;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].City_Name_V.OnMouseLeave := addons.weather.Input.mouse.VLabel.OnMouseLeave;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].City_Name_V.OnClick := addons.weather.Input.mouse.VLabel.OnMouseClick;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].City_Name_V.Tag := vNumPanel;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].City_Name_V.TagFloat := 1000;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].City_Name_V.Visible := True;
  //
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Name := TLabel.Create(vWeather.Config.main.Right.Towns.Town[vNumPanel].Panel);
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Name.name := 'Weather_Config_Towns_CityNum_' + vNumPanel.ToString + '_CCountryName';
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Name.Parent := vWeather.Config.main.Right.Towns.Town[vNumPanel].Panel;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Name.SetBounds(106, 40, 100, 22);
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Name.Text := 'Country : ';
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Name.TextSettings.HorzAlign := TTextAlign.Leading;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Name.StyledSettings := vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Name.StyledSettings -
  // [TStyledSetting.FontColor, TStyledSetting.Size];
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Name.Font.Size := 16;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Name.TextSettings.FontColor := TAlphaColorRec.Deepskyblue;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Name.OnMouseEnter := addons.weather.Input.mouse.VLabel.OnMouseEnter;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Name.OnMouseLeave := addons.weather.Input.mouse.VLabel.OnMouseLeave;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Name.OnClick := addons.weather.Input.mouse.VLabel.OnMouseClick;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Name.Tag := vNumPanel;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Name.TagFloat := 1000;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Name.Visible := True;
  //
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Name_V := TLabel.Create(vWeather.Config.main.Right.Towns.Town[vNumPanel].Panel);
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Name_V.name := 'Weather_Config_Towns_CityNum_V_' + vNumPanel.ToString + '_CCountryName';
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Name_V.Parent := vWeather.Config.main.Right.Towns.Town[vNumPanel].Panel;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Name_V.SetBounds(174, 40, 400, 22);
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Name_V.Text := vNewTown.Country_Name;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Name_V.TextSettings.HorzAlign := TTextAlign.Leading;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Name_V.StyledSettings := vWeather.Config.main.Right.Towns.Town[vNumPanel]
  // .Country_Name_V.StyledSettings - [TStyledSetting.Size];
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Name_V.Font.Size := 16;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Name_V.OnMouseEnter := addons.weather.Input.mouse.VLabel.OnMouseEnter;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Name_V.OnMouseLeave := addons.weather.Input.mouse.VLabel.OnMouseLeave;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Name_V.OnClick := addons.weather.Input.mouse.VLabel.OnMouseClick;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Name_V.Tag := vNumPanel;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Name_V.TagFloat := 1000;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Name_V.Visible := True;
  //
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Flag := TImage.Create(vWeather.Config.main.Right.Towns.Town[vNumPanel].Panel);
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Flag.name := 'Weather_Config_Towns_CityNum_' + vNumPanel.ToString + '_CountryFlag';
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Flag.Parent := vWeather.Config.main.Right.Towns.Town[vNumPanel].Panel;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Flag.SetBounds(vWeather.Config.main.Right.Towns.Town[vNumPanel].Panel.Width - 65,
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Panel.Height - 55, 60, 50);
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Flag.Bitmap := vNewTown.Country_Flag;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Flag.OnMouseEnter := addons.weather.Input.mouse.Image.OnMouseEnter;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Flag.OnMouseLeave := addons.weather.Input.mouse.Image.OnMouseLeave;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Flag.OnClick := addons.weather.Input.mouse.Image.OnMouseClick;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Flag.Tag := vNumPanel;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Flag.TagFloat := 1000;
  // vWeather.Config.main.Right.Towns.Town[vNumPanel].Country_Flag.Visible := True;
end;
/// /////////////////////////////////////////////////////////////////////////////
// Add New town Panel Actions

procedure uWeather_Config_Towns_AddNewTown(vNum: Integer; mWoeid, country_code: string);
var
  vForcast_Resutls: TStringList;
  vDegree: String;
  vDay: byte;
begin
  // vForcast_Resutls := TStringList.Create;
  //
  // if addons.weather.Action.Degree = 'Celcius' then
  // vDegree := 'c'
  // else if addons.weather.Action.Degree = 'Fahrenheit' then
  // vDegree := 'f';
  //
  // vForcast_Resutls.Add(Main_Form.Main_IdHttp.Get('http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20weather.forecast%20where%20woeid%3D' + mWoeid +
  // '%20and%20u%3D%27' + vDegree + '%27&format=xml&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys%20HTTP/1.1'));
  // vForcast_Resutls.SaveToFile(extrafe.prog.Path + cTemp_Forcast);
  //
  // vNTXML := CreateXMLDoc;
  // vNTXML.LoadFromFile(extrafe.prog.Path + cTemp_Forcast);
  // vNTRoot := vNTXML.DocumentElement;
  //
  // SetLength(addons.weather.Action.Choosen, vNum + 1);
  //
  // addons.weather.Action.Choosen[vNum].Provider := addons.weather.Action.Provider;
  // addons.weather.Action.Choosen[vNum].woeid := mWoeid;
  // addons.weather.Action.Choosen[vNum].Country_FlagCode := LowerCase(country_code);
  // vDay := 0;
  //
  // vNTNode := nil;
  //
  // while vNTRoot.GetNextChild(vNTNode) do
  // while vNTNode.GetNextChild(vNTNode_1) do
  // while vNTNode_1.GetNextChild(vNTNode_2) do
  // begin
  // vNTAttribute := nil;
  // if vNTNode_2.NodeName = 'yweather:location' then
  // begin
  // vNTNode_2.FindAttribute('city', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].City := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_2.FindAttribute('country', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].country := vNTAttribute.NodeValue;
  // end
  // else if vNTNode_2.NodeName = 'lastBuildDate' then
  // begin
  // addons.weather.Action.Choosen[vNum].LastUpdate := vNTNode_2.Text;
  // end
  // else if vNTNode_2.NodeName = 'yweather:units' then
  // begin
  // vNTNode_2.FindAttribute('temperature', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].UnitV.Temperature := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_2.FindAttribute('speed', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].UnitV.Speed := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_2.FindAttribute('pressure', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].UnitV.Pressure := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_2.FindAttribute('distance', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].UnitV.Distance := vNTAttribute.NodeValue;
  // end
  // else if vNTNode_2.NodeName = 'yweather:wind' then
  // begin
  // vNTNode_2.FindAttribute('speed', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Wind.Speed := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_2.FindAttribute('direction', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Wind.Direction := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_2.FindAttribute('chill', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Wind.Chill := vNTAttribute.NodeValue;
  // end
  // else if vNTNode_2.NodeName = 'yweather:atmosphere' then
  // begin
  // vNTNode_2.FindAttribute('pressure', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Atmosphere.Pressure := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_2.FindAttribute('visibility', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Atmosphere.Visibility := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_2.FindAttribute('rising', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Atmosphere.Rising := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_2.FindAttribute('humidity', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Atmosphere.Humidity := vNTAttribute.NodeValue;
  // end
  // else if vNTNode_2.NodeName = 'yweather:astronomy' then
  // begin
  // vNTNode_2.FindAttribute('sunset', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Astronomy.Sunset := uWeather_Convert_FixAstronomy(vNTAttribute.NodeValue);
  // vNTAttribute := nil;
  // vNTNode_2.FindAttribute('sunrise', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Astronomy.Sunrise := uWeather_Convert_FixAstronomy(vNTAttribute.NodeValue);
  // end
  // else if vNTNode_2.NodeName = 'item' then
  // begin
  // while vNTNode_2.GetNextChild(vNTNode_3) do
  // begin
  // vNTAttribute := nil;
  // if vNTNode_3.NodeName = 'yweather:condition' then
  // begin
  // vNTNode_3.FindAttribute('temp', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Temp_Condition := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('date', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].LastChecked := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('code', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Code := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('text', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Text_Condtition := vNTAttribute.NodeValue;
  // end
  // else if vNTNode_3.NodeName = 'yweather:forecast' then
  // begin
  // case vDay of
  // 0:
  // begin
  // vNTNode_3.FindAttribute('day', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Current.Text := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('date', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Current.Date := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('text', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Current.Forcast := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('code', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Current.Code := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('low', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Current.Low := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('high', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Current.High := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // inc(vDay, 1);
  // end;
  // 1:
  // begin
  // vNTNode_3.FindAttribute('day', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_1.Text := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('date', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_1.Date := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('text', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_1.Forcast := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('code', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_1.Code := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('low', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_1.Low := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('high', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_1.High := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // inc(vDay, 1);
  // end;
  // 2:
  // begin
  // vNTNode_3.FindAttribute('day', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_2.Text := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('date', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_2.Date := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('text', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_2.Forcast := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('code', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_2.Code := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('low', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_2.Low := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('high', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_2.High := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // inc(vDay, 1);
  // end;
  // 3:
  // begin
  // vNTNode_3.FindAttribute('day', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_3.Text := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('date', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_3.Date := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('text', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_3.Forcast := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('code', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_3.Code := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('low', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_3.Low := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('high', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_3.High := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // inc(vDay, 1);
  // end;
  // 4:
  // begin
  // vNTNode_3.FindAttribute('day', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_4.Text := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('date', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_4.Date := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('text', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_4.Forcast := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('code', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_4.Code := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('low', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_4.Low := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('high', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_4.High := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // inc(vDay, 1);
  // end;
  // 5:
  // begin
  // vNTNode_3.FindAttribute('day', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_5.Text := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('date', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_5.Date := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('text', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_5.Forcast := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('code', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_5.Code := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('low', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_5.Low := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('high', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_5.High := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // inc(vDay, 1);
  // end;
  // 6:
  // begin
  // vNTNode_3.FindAttribute('day', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_6.Text := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('date', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_6.Date := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('text', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_6.Forcast := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('code', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_6.Code := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('low', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_6.Low := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('high', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_6.High := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // inc(vDay, 1);
  // end;
  // 7:
  // begin
  // vNTNode_3.FindAttribute('day', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_7.Text := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('date', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_7.Date := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('text', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_7.Forcast := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('code', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_7.Code := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('low', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_7.Low := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('high', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_7.High := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // inc(vDay, 1);
  // end;
  // 8:
  // begin
  // vNTNode_3.FindAttribute('day', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_8.Text := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('date', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_8.Date := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('text', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_8.Forcast := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('code', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_8.Code := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('low', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_8.Low := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('high', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_8.High := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // inc(vDay, 1);
  // end;
  // 9:
  // begin
  // vNTNode_3.FindAttribute('day', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_9.Text := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('date', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_9.Date := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('text', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_9.Forcast := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('code', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_9.Code := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('low', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_9.Low := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // vNTNode_3.FindAttribute('high', vNTAttribute);
  // addons.weather.Action.Choosen[vNum].Day_9.High := vNTAttribute.NodeValue;
  // vNTAttribute := nil;
  // inc(vDay, 1);
  // end;
  // end;
  // end;
  // end;
  // end;
  // end;
  //
  // addons.weather.Action.Active_Total := vNum;
  // addons.weather.Ini.Ini.WriteInteger('Active', 'Active_Total', addons.weather.Action.Active_Total);
  // addons.weather.Ini.Ini.WriteString(addons.weather.Action.Provider, addons.weather.Action.Active_Total.ToString + '_WoeID',
  // addons.weather.Action.Choosen[vNum].woeid + '{' + addons.weather.Action.Choosen[vNum].Country_FlagCode + '}');
  // // uWeather_Config_Towns_CreateTown_Panel(vNum, addons.weather.Action.Choosen[vNum]);
  // uWeather_Provider_Yahoo_CreateTab(addons.weather.Action.Choosen[vNum], vNum);
  // DeleteFile(extrafe.prog.Path + cTemp_Forcast);
  // end;
  //
  // procedure uWeather_Config_Towns_CreateTown_Panel(mNum: Integer; mTownResults: TADDON_WEATHER_CONFIG_CREATE_PANEL);
  // begin
  // SetLength(vWeather.Config.main.Right.Towns.Town, mNum + 1);
  //
  // vWeather.Config.main.Right.Towns.Town[mNum].Panel := TPanel.Create(vWeather.Config.main.Right.Towns.CityList);
  // vWeather.Config.main.Right.Towns.Town[mNum].Panel.name := 'Weather_Config_Towns_CityNum_' + IntToStr(mNum);
  // vWeather.Config.main.Right.Towns.Town[mNum].Panel.Parent := vWeather.Config.main.Right.Towns.CityList;
  // vWeather.Config.main.Right.Towns.Town[mNum].Panel.SetBounds(6, 6 + (mNum * 86), vWeather.Config.main.Right.Towns.CityList.Width - 24, 80);
  // vWeather.Config.main.Right.Towns.Town[mNum].Panel.OnClick := addons.weather.Input.mouse.Panel.OnMouseClick;
  // vWeather.Config.main.Right.Towns.Town[mNum].Panel.OnMouseEnter := addons.weather.Input.mouse.Panel.OnMouseEnter;
  // vWeather.Config.main.Right.Towns.Town[mNum].Panel.OnMouseLeave := addons.weather.Input.mouse.Panel.OnMouseLeave;
  // vWeather.Config.main.Right.Towns.Town[mNum].Panel.Tag := mNum;
  // vWeather.Config.main.Right.Towns.Town[mNum].Panel.TagFloat := 1000;
  // vWeather.Config.main.Right.Towns.Town[mNum].Panel.Visible := True;
  //
  // vWeather.Config.main.Right.Towns.Town[mNum].Glow_Panel := TGlowEffect.Create(vWeather.Config.main.Right.Towns.Town[mNum].Panel);
  // vWeather.Config.main.Right.Towns.Town[mNum].Glow_Panel.name := 'Weather_Config_Towns_CityNum_' + IntToStr(mNum) + '_Glow';
  // vWeather.Config.main.Right.Towns.Town[mNum].Glow_Panel.Parent := vWeather.Config.main.Right.Towns.Town[mNum].Panel;
  // vWeather.Config.main.Right.Towns.Town[mNum].Glow_Panel.GlowColor := TAlphaColorRec.Deepskyblue;
  // vWeather.Config.main.Right.Towns.Town[mNum].Glow_Panel.Enabled := False;
  // vWeather.Config.main.Right.Towns.Town[mNum].Glow_Panel.Opacity := 0.9;
  // vWeather.Config.main.Right.Towns.Town[mNum].Glow_Panel.Softness := 0.4;
  // vWeather.Config.main.Right.Towns.Town[mNum].Glow_Panel.Tag := mNum;
  //
  // vWeather.Config.main.Right.Towns.Town[mNum].Date := TLabel.Create(vWeather.Config.main.Right.Towns.Town[mNum].Panel);
  // vWeather.Config.main.Right.Towns.Town[mNum].Date.name := 'Weather_Config_Towns_CityNum_' + IntToStr(mNum) + '_Date';
  // vWeather.Config.main.Right.Towns.Town[mNum].Date.Parent := vWeather.Config.main.Right.Towns.Town[mNum].Panel;
  // vWeather.Config.main.Right.Towns.Town[mNum].Date.SetBounds((vWeather.Config.main.Right.Towns.Town[mNum].Panel.Width / 2) - 120, 3, 240, 17);
  // vWeather.Config.main.Right.Towns.Town[mNum].Date.Text := mTownResults.Last_Checked;
  // vWeather.Config.main.Right.Towns.Town[mNum].Date.TextSettings.HorzAlign := TTextAlign.Center;
  // vWeather.Config.main.Right.Towns.Town[mNum].Date.OnMouseEnter := addons.weather.Input.mouse.VLabel.OnMouseEnter;
  // vWeather.Config.main.Right.Towns.Town[mNum].Date.OnMouseLeave := addons.weather.Input.mouse.VLabel.OnMouseLeave;
  // vWeather.Config.main.Right.Towns.Town[mNum].Date.OnClick := addons.weather.Input.mouse.VLabel.OnMouseClick;
  // vWeather.Config.main.Right.Towns.Town[mNum].Date.Tag := mNum;
  // vWeather.Config.main.Right.Towns.Town[mNum].Date.TagFloat := 1000;
  // vWeather.Config.main.Right.Towns.Town[mNum].Date.Visible := True;
  //
  // vWeather.Config.main.Right.Towns.Town[mNum].Image := TImage.Create(vWeather.Config.main.Right.Towns.Town[mNum].Panel);
  // vWeather.Config.main.Right.Towns.Town[mNum].Image.name := 'Weather_Config_Towns_CityNum_' + IntToStr(mNum) + '_Image';
  // vWeather.Config.main.Right.Towns.Town[mNum].Image.Parent := vWeather.Config.main.Right.Towns.Town[mNum].Panel;
  // vWeather.Config.main.Right.Towns.Town[mNum].Image.SetBounds(6, 6, 60, 60);
  // vWeather.Config.main.Right.Towns.Town[mNum].Image.Bitmap.LoadFromFile(addons.weather.Path.Iconsets + addons.weather.Config.Iconset.name + '\w_w_' +
  // mTownResults.Temp_Icon + '.png');
  // vWeather.Config.main.Right.Towns.Town[mNum].Image.OnMouseEnter := addons.weather.Input.mouse.Image.OnMouseEnter;
  // vWeather.Config.main.Right.Towns.Town[mNum].Image.OnMouseLeave := addons.weather.Input.mouse.Image.OnMouseLeave;
  // vWeather.Config.main.Right.Towns.Town[mNum].Image.OnClick := addons.weather.Input.mouse.Image.OnMouseClick;
  // vWeather.Config.main.Right.Towns.Town[mNum].Image.Tag := mNum;
  // vWeather.Config.main.Right.Towns.Town[mNum].Image.TagFloat := 1000;
  // vWeather.Config.main.Right.Towns.Town[mNum].Image.Visible := True;
  //
  // vWeather.Config.main.Right.Towns.Town[mNum].Temp := TLabel.Create(vWeather.Config.main.Right.Towns.Town[mNum].Panel);
  // vWeather.Config.main.Right.Towns.Town[mNum].Temp.name := 'Weather_Config_Towns_CityNum_' + IntToStr(mNum) + '_Temp';
  // vWeather.Config.main.Right.Towns.Town[mNum].Temp.Parent := vWeather.Config.main.Right.Towns.Town[mNum].Panel;
  // vWeather.Config.main.Right.Towns.Town[mNum].Temp.SetBounds(80, 32, 150, 17);
  // vWeather.Config.main.Right.Towns.Town[mNum].Temp.Font.Size := 24;
  // vWeather.Config.main.Right.Towns.Town[mNum].Temp.Text := mTownResults.Temp + ' ͦ ' + mTownResults.Temp_Unit;
  // vWeather.Config.main.Right.Towns.Town[mNum].Temp.TextSettings.HorzAlign := TTextAlign.Leading;
  // vWeather.Config.main.Right.Towns.Town[mNum].Temp.OnMouseEnter := addons.weather.Input.mouse.VLabel.OnMouseEnter;
  // vWeather.Config.main.Right.Towns.Town[mNum].Temp.OnMouseLeave := addons.weather.Input.mouse.VLabel.OnMouseLeave;
  // vWeather.Config.main.Right.Towns.Town[mNum].Temp.OnClick := addons.weather.Input.mouse.VLabel.OnMouseClick;
  // vWeather.Config.main.Right.Towns.Town[mNum].Temp.Tag := mNum;
  // vWeather.Config.main.Right.Towns.Town[mNum].Temp.TagFloat := 1000;
  // vWeather.Config.main.Right.Towns.Town[mNum].Temp.Visible := True;
  //
  // vWeather.Config.main.Right.Towns.Town[mNum].Temp_Comment := TLabel.Create(vWeather.Config.main.Right.Towns.Town[mNum].Panel);
  // vWeather.Config.main.Right.Towns.Town[mNum].Temp_Comment.name := 'Weather_Config_Towns_CityNum_' + IntToStr(mNum) + '_Temp_Comment';
  // vWeather.Config.main.Right.Towns.Town[mNum].Temp_Comment.Parent := vWeather.Config.main.Right.Towns.Town[mNum].Panel;
  // vWeather.Config.main.Right.Towns.Town[mNum].Temp_Comment.SetBounds(6, 60, 300, 17);
  // vWeather.Config.main.Right.Towns.Town[mNum].Temp_Comment.Text := mTownResults.Temp_Description;
  // vWeather.Config.main.Right.Towns.Town[mNum].Temp_Comment.TextSettings.HorzAlign := TTextAlign.Leading;
  // vWeather.Config.main.Right.Towns.Town[mNum].Temp_Comment.OnMouseEnter := addons.weather.Input.mouse.VLabel.OnMouseEnter;
  // vWeather.Config.main.Right.Towns.Town[mNum].Temp_Comment.OnMouseLeave := addons.weather.Input.mouse.VLabel.OnMouseLeave;
  // vWeather.Config.main.Right.Towns.Town[mNum].Temp_Comment.OnClick := addons.weather.Input.mouse.VLabel.OnMouseClick;
  // vWeather.Config.main.Right.Towns.Town[mNum].Temp_Comment.Tag := mNum;
  // vWeather.Config.main.Right.Towns.Town[mNum].Temp_Comment.TagFloat := 1000;
  // vWeather.Config.main.Right.Towns.Town[mNum].Temp_Comment.Visible := True;
  //
  // vWeather.Config.main.Right.Towns.Town[mNum].City_Name := TLabel.Create(vWeather.Config.main.Right.Towns.Town[mNum].Panel);
  // vWeather.Config.main.Right.Towns.Town[mNum].City_Name.name := 'Weather_Config_Towns_CityNum_' + IntToStr(mNum) + '_CityName';
  // vWeather.Config.main.Right.Towns.Town[mNum].City_Name.Parent := vWeather.Config.main.Right.Towns.Town[mNum].Panel;
  // vWeather.Config.main.Right.Towns.Town[mNum].City_Name.SetBounds(140, 32, 200, 17);
  // vWeather.Config.main.Right.Towns.Town[mNum].City_Name.Text := 'City Name : ';
  // vWeather.Config.main.Right.Towns.Town[mNum].City_Name.StyledSettings := vWeather.Config.main.Right.Towns.Town[mNum].City_Name.StyledSettings -
  // [TStyledSetting.FontColor];
  // vWeather.Config.main.Right.Towns.Town[mNum].City_Name.TextSettings.FontColor := TAlphaColorRec.Deepskyblue;
  // vWeather.Config.main.Right.Towns.Town[mNum].City_Name.TextSettings.HorzAlign := TTextAlign.Leading;
  // vWeather.Config.main.Right.Towns.Town[mNum].City_Name.OnMouseEnter := addons.weather.Input.mouse.VLabel.OnMouseEnter;
  // vWeather.Config.main.Right.Towns.Town[mNum].City_Name.OnMouseLeave := addons.weather.Input.mouse.VLabel.OnMouseLeave;
  // vWeather.Config.main.Right.Towns.Town[mNum].City_Name.OnClick := addons.weather.Input.mouse.VLabel.OnMouseClick;
  // vWeather.Config.main.Right.Towns.Town[mNum].City_Name.Tag := mNum;
  // vWeather.Config.main.Right.Towns.Town[mNum].City_Name.TagFloat := 1000;
  // vWeather.Config.main.Right.Towns.Town[mNum].City_Name.Visible := True;
  //
  // vWeather.Config.main.Right.Towns.Town[mNum].City_Name_V := TLabel.Create(vWeather.Config.main.Right.Towns.Town[mNum].Panel);
  // vWeather.Config.main.Right.Towns.Town[mNum].City_Name_V.name := 'Weather_Config_Towns_CityNum_V_' + IntToStr(mNum) + '_CityName';
  // vWeather.Config.main.Right.Towns.Town[mNum].City_Name_V.Parent := vWeather.Config.main.Right.Towns.Town[mNum].Panel;
  // vWeather.Config.main.Right.Towns.Town[mNum].City_Name_V.SetBounds(210, 32, 200, 17);
  // vWeather.Config.main.Right.Towns.Town[mNum].City_Name_V.Text := mTownResults.City_Name;
  // vWeather.Config.main.Right.Towns.Town[mNum].City_Name_V.TextSettings.HorzAlign := TTextAlign.Leading;
  // vWeather.Config.main.Right.Towns.Town[mNum].City_Name_V.OnMouseEnter := addons.weather.Input.mouse.VLabel.OnMouseEnter;
  // vWeather.Config.main.Right.Towns.Town[mNum].City_Name_V.OnMouseLeave := addons.weather.Input.mouse.VLabel.OnMouseLeave;
  // vWeather.Config.main.Right.Towns.Town[mNum].City_Name_V.OnClick := addons.weather.Input.mouse.VLabel.OnMouseClick;
  // vWeather.Config.main.Right.Towns.Town[mNum].City_Name_V.Tag := mNum;
  // vWeather.Config.main.Right.Towns.Town[mNum].City_Name_V.TagFloat := 1000;
  // vWeather.Config.main.Right.Towns.Town[mNum].City_Name_V.Visible := True;
  //
  // vWeather.Config.main.Right.Towns.Town[mNum].Country_Name := TLabel.Create(vWeather.Config.main.Right.Towns.Town[mNum].Panel);
  // vWeather.Config.main.Right.Towns.Town[mNum].Country_Name.name := 'Weather_Config_Towns_CityNum_' + IntToStr(mNum) + '_CCountryName';
  // vWeather.Config.main.Right.Towns.Town[mNum].Country_Name.Parent := vWeather.Config.main.Right.Towns.Town[mNum].Panel;
  // vWeather.Config.main.Right.Towns.Town[mNum].Country_Name.SetBounds(140, 60, 300, 17);
  // vWeather.Config.main.Right.Towns.Town[mNum].Country_Name.Text := 'Country Name : ';
  // vWeather.Config.main.Right.Towns.Town[mNum].Country_Name.TextSettings.HorzAlign := TTextAlign.Leading;
  // vWeather.Config.main.Right.Towns.Town[mNum].Country_Name.StyledSettings := vWeather.Config.main.Right.Towns.Town[mNum].Country_Name.StyledSettings -
  // [TStyledSetting.FontColor];
  // vWeather.Config.main.Right.Towns.Town[mNum].Country_Name.TextSettings.FontColor := TAlphaColorRec.Deepskyblue;
  // vWeather.Config.main.Right.Towns.Town[mNum].Country_Name.OnMouseEnter := addons.weather.Input.mouse.VLabel.OnMouseEnter;
  // vWeather.Config.main.Right.Towns.Town[mNum].Country_Name.OnMouseLeave := addons.weather.Input.mouse.VLabel.OnMouseLeave;
  // vWeather.Config.main.Right.Towns.Town[mNum].Country_Name.OnClick := addons.weather.Input.mouse.VLabel.OnMouseClick;
  // vWeather.Config.main.Right.Towns.Town[mNum].Country_Name.Tag := mNum;
  // vWeather.Config.main.Right.Towns.Town[mNum].Country_Name.TagFloat := 1000;
  // vWeather.Config.main.Right.Towns.Town[mNum].Country_Name.Visible := True;
  //
  // vWeather.Config.main.Right.Towns.Town[mNum].Country_Name_V := TLabel.Create(vWeather.Config.main.Right.Towns.Town[mNum].Panel);
  // vWeather.Config.main.Right.Towns.Town[mNum].Country_Name_V.name := 'Weather_Config_Towns_CityNum_V_' + IntToStr(mNum) + '_CCountryName';
  // vWeather.Config.main.Right.Towns.Town[mNum].Country_Name_V.Parent := vWeather.Config.main.Right.Towns.Town[mNum].Panel;
  // vWeather.Config.main.Right.Towns.Town[mNum].Country_Name_V.SetBounds(240, 60, 300, 17);
  // vWeather.Config.main.Right.Towns.Town[mNum].Country_Name_V.Text := mTownResults.Country_Name;
  // vWeather.Config.main.Right.Towns.Town[mNum].Country_Name_V.TextSettings.HorzAlign := TTextAlign.Leading;
  // vWeather.Config.main.Right.Towns.Town[mNum].Country_Name_V.OnMouseEnter := addons.weather.Input.mouse.VLabel.OnMouseEnter;
  // vWeather.Config.main.Right.Towns.Town[mNum].Country_Name_V.OnMouseLeave := addons.weather.Input.mouse.VLabel.OnMouseLeave;
  // vWeather.Config.main.Right.Towns.Town[mNum].Country_Name_V.OnClick := addons.weather.Input.mouse.VLabel.OnMouseClick;
  // vWeather.Config.main.Right.Towns.Town[mNum].Country_Name_V.Tag := mNum;
  // vWeather.Config.main.Right.Towns.Town[mNum].Country_Name_V.TagFloat := 1000;
  // vWeather.Config.main.Right.Towns.Town[mNum].Country_Name_V.Visible := True;
  //
  // vWeather.Config.main.Right.Towns.Town[mNum].Country_Flag := TImage.Create(vWeather.Config.main.Right.Towns.Town[mNum].Panel);
  // vWeather.Config.main.Right.Towns.Town[mNum].Country_Flag.name := 'Weather_Config_Towns_CityNum_' + IntToStr(mNum) + '_CountryFlag';
  // vWeather.Config.main.Right.Towns.Town[mNum].Country_Flag.Parent := vWeather.Config.main.Right.Towns.Town[mNum].Panel;
  // vWeather.Config.main.Right.Towns.Town[mNum].Country_Flag.Width := 50;
  // vWeather.Config.main.Right.Towns.Town[mNum].Country_Flag.Height := 40;
  // vWeather.Config.main.Right.Towns.Town[mNum].Country_Flag.Position.X := 350;
  // vWeather.Config.main.Right.Towns.Town[mNum].Country_Flag.Position.Y := 20;
  // vWeather.Config.main.Right.Towns.Town[mNum].Country_Flag.Bitmap.LoadFromFile(ex_main.Paths.Flags_Images + mTownResults.Country_Flag + '.png');
  // vWeather.Config.main.Right.Towns.Town[mNum].Country_Flag.OnMouseEnter := addons.weather.Input.mouse.Image.OnMouseEnter;
  // vWeather.Config.main.Right.Towns.Town[mNum].Country_Flag.OnMouseLeave := addons.weather.Input.mouse.Image.OnMouseLeave;
  // vWeather.Config.main.Right.Towns.Town[mNum].Country_Flag.OnClick := addons.weather.Input.mouse.Image.OnMouseClick;
  // vWeather.Config.main.Right.Towns.Town[mNum].Country_Flag.Tag := mNum;
  // vWeather.Config.main.Right.Towns.Town[mNum].Country_Flag.TagFloat := 1000;
  // vWeather.Config.main.Right.Towns.Town[mNum].Country_Flag.Visible := True;
end;

procedure uWeather_Config_Towns_TownGoUp;
// var
// vGoto: Integer;
// vCurrentTown, vChangedTown: TADDON_WEATHER_CHOOSENTOWN;
// vi: Integer;
begin
  // vGoto := addons.weather.Config.Selected_Town - 1;
  //
  // // Change the string record
  // vCurrentTown := addons.weather.Action.Choosen[addons.weather.Config.Selected_Town];
  // vChangedTown := addons.weather.Action.Choosen[vGoto];
  //
  // addons.weather.Action.Choosen[vGoto] := vCurrentTown;
  // addons.weather.Action.Choosen[addons.weather.Config.Selected_Town] := vChangedTown;
  //
  // // Change the places of the panels in town config
  // for vi := 0 to addons.weather.Action.Active_Total do
  // FreeAndNil(vWeather.Config.main.Right.Towns.Town[vi]);
  //
  // // for vi := 0 to addons.weather.Action.Active_Total do
  // // uWeather_Config_Towns_CreateTown_Panel(vi, addons.weather.Action.Choosen[vi]);
  //
  // // Change the main
  // FreeAndNil(vWeather.Scene.Control);
  //
  // uWeather_SetAll_Create_Control;
  // for vi := 0 to addons.weather.Action.Active_Total do
  // uWeather_Provider_Yahoo_CreateTab(addons.weather.Action.Choosen[vi], vi);
  //
  // for vi := 0 to addons.weather.Action.Active_Total do
  // vWeather.Scene.Tab[vi].Tab.Visible := True;
  //
  // vWeather.Scene.Blur.Enabled := False;
  // vWeather.Scene.Control.TabIndex := 0;
  // vWeather.Scene.Blur.Enabled := True;
  //
  // // Change in ini
  // for vi := 0 to addons.weather.Action.Active_Total do
  // addons.weather.Ini.Ini.DeleteKey(addons.weather.Action.Provider, vi.ToString + '_WoeID');
  //
  // for vi := 0 to addons.weather.Action.Active_Total do
  // addons.weather.Ini.Ini.WriteString(addons.weather.Action.Provider, vi.ToString + '_WoeID', addons.weather.Action.Choosen[vi].woeid + '{' +
  // addons.weather.Action.Choosen[vi].Country_FlagCode + '}');
  //
  // if vGoto = 0 then
  // begin
  // vWeather.Config.main.Right.Towns.GoUp_Glow.Enabled := False;
  // vWeather.Config.main.Right.Towns.GoUp.TextSettings.FontColor := TAlphaColorRec.Grey;
  // end;
  //
  // for vi := 0 to addons.weather.Action.Active_Total do
  // vWeather.Config.main.Right.Towns.Town[vi].Glow_Panel.Enabled := False;
  //
  // // Yparxei problima edo
  // vWeather.Config.main.Right.Towns.Town[vGoto].Glow_Panel.Enabled := True;
  // vWeather.Config.main.Right.Towns.Town[vGoto].Glow_Panel.GlowColor := TAlphaColorRec.Red;
  //
  // Dec(addons.weather.Config.Selected_Town, 1);
end;

procedure uWeather_Config_Towns_TownGoDown;
// var
// vGoto: Integer;
// vCurrentTown, vChangedTown: TADDON_WEATHER_CHOOSENTOWN;
// vi: Integer;
begin
  // vGoto := addons.weather.Config.Selected_Town + 1;
  //
  // // Change the string record
  // vCurrentTown := addons.weather.Action.Choosen[addons.weather.Config.Selected_Town];
  // vChangedTown := addons.weather.Action.Choosen[vGoto];
  //
  // addons.weather.Action.Choosen[vGoto] := vCurrentTown;
  // addons.weather.Action.Choosen[addons.weather.Config.Selected_Town] := vChangedTown;
  //
  // // Change the places of the panels in town config
  // for vi := 0 to addons.weather.Action.Active_Total do
  // FreeAndNil(vWeather.Config.main.Right.Towns.Town[vi]);
  //
  // // for vi := 0 to addons.weather.Action.Active_Total do
  // // uWeather_Config_Towns_CreateTown_Panel(vi, addons.weather.Action.Choosen[vi]);
  //
  // // Change the main
  // FreeAndNil(vWeather.Scene.Control);
  //
  // uWeather_SetAll_Create_Control;
  // for vi := 0 to addons.weather.Action.Active_Total do
  // uWeather_Provider_Yahoo_CreateTab(addons.weather.Action.Choosen[vi], vi);
  //
  // for vi := 0 to addons.weather.Action.Active_Total do
  // vWeather.Scene.Tab[vi].Tab.Visible := True;
  //
  // vWeather.Scene.Blur.Enabled := False;
  // vWeather.Scene.Control.TabIndex := 0;
  // vWeather.Scene.Blur.Enabled := True;
  //
  // // Change in ini
  // for vi := 0 to addons.weather.Action.Active_Total do
  // addons.weather.Ini.Ini.DeleteKey(addons.weather.Action.Provider, vi.ToString + '_WoeID');
  //
  // for vi := 0 to addons.weather.Action.Active_Total do
  // addons.weather.Ini.Ini.WriteString(addons.weather.Action.Provider, vi.ToString + '_WoeID', addons.weather.Action.Choosen[vi].woeid + '{' +
  // addons.weather.Action.Choosen[vi].Country_FlagCode + '}');
  //
  // if vGoto = addons.weather.Action.Active_Total then
  // begin
  // vWeather.Config.main.Right.Towns.GoDown_Glow.Enabled := False;
  // vWeather.Config.main.Right.Towns.GoDown.TextSettings.FontColor := TAlphaColorRec.Grey;
  // end;
  //
  // for vi := 0 to addons.weather.Action.Active_Total do
  // vWeather.Config.main.Right.Towns.Town[vi].Glow_Panel.Enabled := False;
  //
  // // Yparxei problima edo
  // vWeather.Config.main.Right.Towns.Town[vGoto].Glow_Panel.Enabled := True;
  // vWeather.Config.main.Right.Towns.Town[vGoto].Glow_Panel.GlowColor := TAlphaColorRec.Red;
  //
  // inc(addons.weather.Config.Selected_Town, 1);
end;

procedure uWeather_Config_Towns_RefreshTown(mNum: Integer);
var
  vForcast_Resutls: TStringList;
  vString_Provider: string;
  vString_Woeid: String;
  vString_Temp_Unit: WideString;
  viPos: Integer;
begin
  vForcast_Resutls := TStringList.Create;

  vString_Provider := addons.weather.Ini.Ini.ReadString('Provider', 'Name', vString_Provider);
  vString_Woeid := addons.weather.Ini.Ini.ReadString(vString_Provider, IntToStr(mNum) + '_WoeID', vString_Woeid);
  viPos := Pos('{', vString_Woeid);
  vString_Woeid := Trim(Copy(vString_Woeid, 0, viPos - 1));

  vForcast_Resutls.Add(Main_Form.Main_IdHttp.Get('http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20weather.forecast%20where%20woeid%3D' +
    vString_Woeid + '%20and%20u%3D%27c%27&format=xml&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys%20HTTP/1.1'));
  vForcast_Resutls.SaveToFile(extrafe.prog.Path + cTemp_Forcast);

  vNTXML := CreateXMLDoc;
  vNTXML.LoadFromFile(extrafe.prog.Path + cTemp_Forcast);
  vNTRoot := vNTXML.DocumentElement;
  vNTNode := nil;

  while vNTRoot.GetNextChild(vNTNode) do
    while vNTNode.GetNextChild(vNTNode_1) do
      while vNTNode_1.GetNextChild(vNTNode_2) do
      begin
        vNTAttribute := nil;
        if vNTNode_2.NodeName = 'yweather:units' then
        begin
          vNTNode_2.FindAttribute('temperature', vNTAttribute);
          vString_Temp_Unit := vNTAttribute.NodeValue;
        end
        else if vNTNode_2.NodeName = 'item' then
        begin
          while vNTNode_2.GetNextChild(vNTNode_3) do
          begin
            vNTAttribute := nil;
            if vNTNode_3.NodeName = 'yweather:condition' then
            begin
              vNTNode_3.FindAttribute('temp', vNTAttribute);
              vNTAttribute := nil;
              vNTNode_3.FindAttribute('date', vNTAttribute);
              vNTAttribute := nil;
              vNTNode_3.FindAttribute('code', vNTAttribute);
              vNTAttribute := nil;
              vNTNode_3.FindAttribute('text', vNTAttribute);
            end;
          end;
        end;
      end;
  DeleteFile(extrafe.prog.Path + cTemp_Forcast);
end;

///

procedure uWeather_Config_Towns_Edit(vLock: Boolean);
var
  vi: Integer;
  vActive_Woeid: Integer;
begin
  if addons.weather.Action.Provider = 'yahoo' then
    vActive_Woeid := addons.weather.Action.Yahoo.Total_WoeID
  else if addons.weather.Action.Provider = 'openweathermap' then
    vActive_Woeid := addons.weather.Action.OWM.Total_WoeID;

  if vActive_Woeid > -1 then
  begin
    if vLock then
    begin
      vWeather.Config.main.Right.Towns.EditLock.Text := #$e990;
      vWeather.Config.main.Right.Towns.Delete_Icon.TextSettings.FontColor := TAlphaColorRec.Deepskyblue;
      addons.weather.Config.Selected_Town := 0;
      vWeather.Config.main.Right.Towns.Town[0].Glow_Panel.Enabled := True;
      vWeather.Config.main.Right.Towns.Town[0].Glow_Panel.GlowColor := TAlphaColorRec.Red;
      vWeather.Config.main.Right.Towns.GoUp.TextSettings.FontColor := TAlphaColorRec.Grey;
      if addons.weather.Action.Provider = 'yahoo' then
      begin
        if addons.weather.Action.Active_Total > 0 then
          vWeather.Config.main.Right.Towns.GoDown.TextSettings.FontColor := TAlphaColorRec.Deepskyblue
        else
          vWeather.Config.main.Right.Towns.GoDown.TextSettings.FontColor := TAlphaColorRec.Grey;
      end;
      uWeather_Sounds_PlayMouse('Lock');
    end
    else
    begin
      vWeather.Config.main.Right.Towns.EditLock.Text := #$e98f;
      vWeather.Config.main.Right.Towns.GoUp.TextSettings.FontColor := TAlphaColorRec.Grey;
      vWeather.Config.main.Right.Towns.GoDown.TextSettings.FontColor := TAlphaColorRec.Grey;
      vWeather.Config.main.Right.Towns.Delete_Icon.TextSettings.FontColor := TAlphaColorRec.Grey;
      if addons.weather.Action.Provider = 'yahoo' then
      begin
        for vi := 0 to addons.weather.Action.Yahoo.Total_WoeID do
        begin
          vWeather.Config.main.Right.Towns.Town[vi].Glow_Panel.GlowColor := TAlphaColorRec.Deepskyblue;
          vWeather.Config.main.Right.Towns.Town[vi].Glow_Panel.Enabled := False;
        end;
      end
      else if addons.weather.Action.Provider = 'openweathermap' then
      begin
        for vi := 0 to addons.weather.Action.OWM.Total_WoeID do
        begin
          vWeather.Config.main.Right.Towns.Town[vi].Glow_Panel.GlowColor := TAlphaColorRec.Deepskyblue;
          vWeather.Config.main.Right.Towns.Town[vi].Glow_Panel.Enabled := False;
        end;
      end;
      uWeather_Sounds_PlayMouse('Unlock');
    end;
    addons.weather.Config.Edit_Lock := vLock;
  end;
end;

procedure uWeather_Config_Towns_Edit_SelectTown(vSelected: Integer);
var
  vi: Integer;
begin
  for vi := 0 to addons.weather.Action.Active_Total do
  begin
    vWeather.Config.main.Right.Towns.Town[vi].Glow_Panel.GlowColor := TAlphaColorRec.Deepskyblue;
    vWeather.Config.main.Right.Towns.Town[vi].Glow_Panel.Enabled := False;
  end;

  vWeather.Config.main.Right.Towns.Town[vSelected].Glow_Panel.GlowColor := TAlphaColorRec.Red;
  vWeather.Config.main.Right.Towns.Town[vSelected].Glow_Panel.Enabled := True;
  addons.weather.Config.Selected_Town := vSelected;

  vWeather.Config.main.Right.Towns.GoUp.TextSettings.FontColor := TAlphaColorRec.Deepskyblue;
  vWeather.Config.main.Right.Towns.GoDown.TextSettings.FontColor := TAlphaColorRec.Deepskyblue;
  if vSelected = 0 then
    vWeather.Config.main.Right.Towns.GoUp.TextSettings.FontColor := TAlphaColorRec.Grey
  else if vSelected = addons.weather.Action.Active_Total then
    vWeather.Config.main.Right.Towns.GoDown.TextSettings.FontColor := TAlphaColorRec.Grey;
end;

procedure uWeather_Config_Towns_Edit_DeleteTown(vSelected: Integer);
begin

end;

procedure uWeather_Config_Towsn_RefreshTownAll;
var
  vi: Integer;
begin
  for vi := 0 to addons.weather.Action.Active_Total do
    uWeather_Config_Towns_RefreshTown(vi);
end;

end.
